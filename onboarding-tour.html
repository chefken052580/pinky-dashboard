<!-- Enhanced Pinky Onboarding Tour with Multiple Slides -->
<div id="onboarding-overlay" style="
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, #0a1428 0%, #1a2847 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  color: #e0e0e0;
  overflow: hidden;
">
  <div id="onboarding-container" style="
    background: rgba(20, 40, 80, 0.95);
    border: 2px solid rgba(68, 150, 255, 0.3);
    border-radius: 16px;
    padding: 0;
    max-width: 700px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    position: relative;
  ">
    <!-- Progress Bar -->
    <div style="
      position: sticky;
      top: 0;
      background: rgba(20, 40, 80, 0.98);
      padding: 1rem 2rem 0.5rem;
      border-bottom: 1px solid rgba(68, 150, 255, 0.2);
      z-index: 1;
    ">
      <div style="
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.75rem;
      ">
        <span id="slide-counter" style="font-size: 0.9em; color: #9999cc;">Step 1 of 6</span>
        <button id="skip-tour" style="
          background: transparent;
          border: 1px solid rgba(68, 150, 255, 0.3);
          color: #9999cc;
          padding: 0.25rem 0.75rem;
          border-radius: 4px;
          cursor: pointer;
          font-size: 0.85em;
          transition: all 0.2s;
        ">Skip Tour</button>
      </div>
      <div id="progress-dots" style="
        display: flex;
        gap: 0.5rem;
        justify-content: center;
      ">
        <!-- Progress dots will be generated by JS -->
      </div>
    </div>

    <!-- Slides Container -->
    <div id="slides-container" style="padding: 2rem;">
      
      <!-- Slide 1: Welcome -->
      <div class="onboarding-slide active" data-slide="1">
        <div style="text-align: center; margin-bottom: 2rem;">
          <div style="font-size: 4em; margin-bottom: 1rem; animation: bounce 1s ease-in-out;">üê≠</div>
          <h1 style="margin: 0 0 0.5rem 0; font-size: 2.2em; color: #4496ff;">Welcome to PinkyBot</h1>
          <p style="color: #aaaadd; font-size: 1.1em; margin: 0;">Your Autonomous AI Assistant for World Domination</p>
        </div>
        <div style="
          background: rgba(68, 150, 255, 0.1);
          border-left: 3px solid #4496ff;
          padding: 1.5rem;
          border-radius: 8px;
          margin: 2rem 0;
        ">
          <p style="margin: 0; line-height: 1.6; color: #e0e0e0;">
            PinkyBot is an <strong>autonomous AI system</strong> that helps you manage tasks, monitor systems, 
            and automate workflows. Think of it as your personal AI team working 24/7 to keep everything running smoothly.
          </p>
        </div>
        <div style="
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
          margin-top: 2rem;
        ">
          <div style="
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
          ">
            <div style="font-size: 2em; margin-bottom: 0.5rem;">ü§ñ</div>
            <div style="color: #aaaadd;">AI-Powered Bots</div>
          </div>
          <div style="
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
          ">
            <div style="font-size: 2em; margin-bottom: 0.5rem;">üìä</div>
            <div style="color: #aaaadd;">Real-Time Analytics</div>
          </div>
          <div style="
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
          ">
            <div style="font-size: 2em; margin-bottom: 0.5rem;">‚ö°</div>
            <div style="color: #aaaadd;">Automated Tasks</div>
          </div>
          <div style="
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
          ">
            <div style="font-size: 2em; margin-bottom: 0.5rem;">üîß</div>
            <div style="color: #aaaadd;">System Monitoring</div>
          </div>
        </div>
      </div>

      <!-- Slide 2: What PinkyBot Does -->
      <div class="onboarding-slide" data-slide="2" style="display: none;">
        <div style="text-align: center; margin-bottom: 2rem;">
          <div style="font-size: 3em; margin-bottom: 0.5rem;">üéØ</div>
          <h2 style="margin: 0 0 0.5rem 0; font-size: 1.8em; color: #4496ff;">What Can PinkyBot Do?</h2>
          <p style="color: #9999cc; margin: 0;">Here's a glimpse of what your AI assistant can handle</p>
        </div>
        <div style="display: flex; flex-direction: column; gap: 1.5rem;">
          <div style="
            background: rgba(68, 150, 255, 0.1);
            padding: 1.25rem;
            border-radius: 8px;
            border-left: 3px solid #4496ff;
          ">
            <div style="display: flex; align-items: start; gap: 1rem;">
              <div style="font-size: 2em;">üìã</div>
              <div>
                <h3 style="margin: 0 0 0.5rem 0; color: #e0e0e0;">Task Management</h3>
                <p style="margin: 0; color: #aaaadd; line-height: 1.5;">
                  Create, prioritize, and track tasks automatically. TasksBot manages your entire workflow and keeps you updated on progress.
                </p>
              </div>
            </div>
          </div>
          <div style="
            background: rgba(68, 150, 255, 0.1);
            padding: 1.25rem;
            border-radius: 8px;
            border-left: 3px solid #4496ff;
          ">
            <div style="display: flex; align-items: start; gap: 1rem;">
              <div style="font-size: 2em;">üè•</div>
              <div>
                <h3 style="margin: 0 0 0.5rem 0; color: #e0e0e0;">System Health Monitoring</h3>
                <p style="margin: 0; color: #aaaadd; line-height: 1.5;">
                  Real-time CPU, memory, and disk monitoring. Get alerts when resources are running low or systems need attention.
                </p>
              </div>
            </div>
          </div>
          <div style="
            background: rgba(68, 150, 255, 0.1);
            padding: 1.25rem;
            border-radius: 8px;
            border-left: 3px solid #4496ff;
          ">
            <div style="display: flex; align-items: start; gap: 1rem;">
              <div style="font-size: 2em;">üí¨</div>
              <div>
                <h3 style="margin: 0 0 0.5rem 0; color: #e0e0e0;">Smart Conversations</h3>
                <p style="margin: 0; color: #aaaadd; line-height: 1.5;">
                  Chat naturally with your bot army. They understand context, remember conversations, and provide intelligent responses.
                </p>
              </div>
            </div>
          </div>
          <div style="
            background: rgba(68, 150, 255, 0.1);
            padding: 1.25rem;
            border-radius: 8px;
            border-left: 3px solid #4496ff;
          ">
            <div style="display: flex; align-items: start; gap: 1rem;">
              <div style="font-size: 2em;">üìä</div>
              <div>
                <h3 style="margin: 0 0 0.5rem 0; color: #e0e0e0;">Analytics & Insights</h3>
                <p style="margin: 0; color: #aaaadd; line-height: 1.5;">
                  Track productivity, token usage, and bot efficiency. Data-driven insights help optimize your AI team.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 3: Dashboard Overview -->
      <div class="onboarding-slide" data-slide="3" style="display: none;">
        <div style="text-align: center; margin-bottom: 2rem;">
          <div style="font-size: 3em; margin-bottom: 0.5rem;">üéõÔ∏è</div>
          <h2 style="margin: 0 0 0.5rem 0; font-size: 1.8em; color: #4496ff;">Your Mission Control</h2>
          <p style="color: #9999cc; margin: 0;">Everything you need in one powerful interface</p>
        </div>
        <div style="
          background: rgba(255, 255, 255, 0.05);
          border-radius: 12px;
          padding: 1.5rem;
          margin-bottom: 1.5rem;
        ">
          <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 600 300'%3E%3Crect fill='%231a2847' width='600' height='300'/%3E%3Ctext x='300' y='150' font-family='Arial' font-size='20' fill='%234496ff' text-anchor='middle'%3EDashboard Preview%3C/text%3E%3Crect x='20' y='30' width='150' height='240' fill='%232d3e5f' rx='8'/%3E%3Crect x='190' y='30' width='390' height='240' fill='%232d3e5f' rx='8'/%3E%3Ccircle cx='95' cy='80' r='15' fill='%234496ff'/%3E%3Ccircle cx='95' cy='130' r='15' fill='%234496ff'/%3E%3Ccircle cx='95' cy='180' r='15' fill='%234496ff'/%3E%3Crect x='220' y='60' width='330' height='20' fill='%234496ff' rx='4'/%3E%3Crect x='220' y='100' width='250' height='15' fill='%236699cc' rx='4'/%3E%3Crect x='220' y='140' width='280' height='15' fill='%236699cc' rx='4'/%3E%3Crect x='220' y='180' width='200' height='15' fill='%236699cc' rx='4'/%3E%3C/svg%3E" style="width: 100%; border-radius: 8px;" alt="Dashboard Layout" />
        </div>
        <div style="display: flex; flex-direction: column; gap: 1rem;">
          <div style="display: flex; align-items: center; gap: 1rem;">
            <div style="
              background: rgba(68, 150, 255, 0.2);
              width: 40px;
              height: 40px;
              border-radius: 8px;
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 1.5em;
            ">üì±</div>
            <div style="flex: 1;">
              <h4 style="margin: 0 0 0.25rem 0; color: #e0e0e0;">Sidebar Navigation</h4>
              <p style="margin: 0; color: #9999cc; font-size: 0.9em;">Quick access to all your bots and features</p>
            </div>
          </div>
          <div style="display: flex; align-items: center; gap: 1rem;">
            <div style="
              background: rgba(68, 150, 255, 0.2);
              width: 40px;
              height: 40px;
              border-radius: 8px;
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 1.5em;
            ">üìä</div>
            <div style="flex: 1;">
              <h4 style="margin: 0 0 0.25rem 0; color: #e0e0e0;">Main Content Area</h4>
              <p style="margin: 0; color: #9999cc; font-size: 0.9em;">View tasks, chat logs, analytics, and more</p>
            </div>
          </div>
          <div style="display: flex; align-items: center; gap: 1rem;">
            <div style="
              background: rgba(68, 150, 255, 0.2);
              width: 40px;
              height: 40px;
              border-radius: 8px;
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 1.5em;
            ">üîî</div>
            <div style="flex: 1;">
              <h4 style="margin: 0 0 0.25rem 0; color: #e0e0e0;">Status Bar</h4>
              <p style="margin: 0; color: #9999cc; font-size: 0.9em;">Real-time system status and notifications</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 4: Bot Army -->
      <div class="onboarding-slide" data-slide="4" style="display: none;">
        <div style="text-align: center; margin-bottom: 2rem;">
          <div style="font-size: 3em; margin-bottom: 0.5rem;">ü§ñ</div>
          <h2 style="margin: 0 0 0.5rem 0; font-size: 1.8em; color: #4496ff;">Meet Your Bot Army</h2>
          <p style="color: #9999cc; margin: 0;">Each bot specializes in different tasks</p>
        </div>
        <div style="
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 1rem;
          margin-bottom: 1.5rem;
        ">
          <div style="
            background: rgba(68, 150, 255, 0.1);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(68, 150, 255, 0.3);
          ">
            <div style="font-size: 2em; margin-bottom: 0.5rem;">üìä</div>
            <h4 style="margin: 0 0 0.5rem 0; color: #e0e0e0;">Dashboard Bot</h4>
            <p style="margin: 0; color: #9999cc; font-size: 0.85em;">Overview and quick stats</p>
          </div>
          <div style="
            background: rgba(68, 150, 255, 0.1);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(68, 150, 255, 0.3);
          ">
            <div style="font-size: 2em; margin-bottom: 0.5rem;">üìã</div>
            <h4 style="margin: 0 0 0.5rem 0; color: #e0e0e0;">TasksBot</h4>
            <p style="margin: 0; color: #9999cc; font-size: 0.85em;">Task management expert</p>
          </div>
          <div style="
            background: rgba(68, 150, 255, 0.1);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(68, 150, 255, 0.3);
          ">
            <div style="font-size: 2em; margin-bottom: 0.5rem;">üí¨</div>
            <h4 style="margin: 0 0 0.5rem 0; color: #e0e0e0;">Chat Bot</h4>
            <p style="margin: 0; color: #9999cc; font-size: 0.85em;">Natural conversations</p>
          </div>
          <div style="
            background: rgba(68, 150, 255, 0.1);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(68, 150, 255, 0.3);
          ">
            <div style="font-size: 2em; margin-bottom: 0.5rem;">üè•</div>
            <h4 style="margin: 0 0 0.5rem 0; color: #e0e0e0;">Health Bot</h4>
            <p style="margin: 0; color: #9999cc; font-size: 0.85em;">System monitoring</p>
          </div>
          <div style="
            background: rgba(68, 150, 255, 0.1);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(68, 150, 255, 0.3);
          ">
            <div style="font-size: 2em; margin-bottom: 0.5rem;">üìà</div>
            <h4 style="margin: 0 0 0.5rem 0; color: #e0e0e0;">Analytics Bot</h4>
            <p style="margin: 0; color: #9999cc; font-size: 0.85em;">Performance insights</p>
          </div>
          <div style="
            background: rgba(68, 150, 255, 0.1);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid rgba(68, 150, 255, 0.3);
          ">
            <div style="font-size: 2em; margin-bottom: 0.5rem;">‚öôÔ∏è</div>
            <h4 style="margin: 0 0 0.5rem 0; color: #e0e0e0;">Settings Bot</h4>
            <p style="margin: 0; color: #9999cc; font-size: 0.85em;">Configuration control</p>
          </div>
        </div>
        <div style="
          background: rgba(68, 150, 255, 0.1);
          border-left: 3px solid #4496ff;
          padding: 1rem;
          border-radius: 8px;
        ">
          <p style="margin: 0; color: #e0e0e0; line-height: 1.5;">
            <strong>üí° Pro Tip:</strong> You can add more specialized bots as your needs grow. Each bot can be customized to fit your workflow.
          </p>
        </div>
      </div>

      <!-- Slide 5: Setup Form -->
      <div class="onboarding-slide" data-slide="5" style="display: none;">
        <div style="text-align: center; margin-bottom: 2rem;">
          <div style="font-size: 3em; margin-bottom: 0.5rem;">üîß</div>
          <h2 style="margin: 0 0 0.5rem 0; font-size: 1.8em; color: #4496ff;">Let's Get You Set Up</h2>
          <p style="color: #9999cc; margin: 0;">Just a few details to personalize your experience</p>
        </div>
        
        <form id="onboarding-form" style="display: flex; flex-direction: column; gap: 1.5rem;">
          <!-- Name Input -->
          <div>
            <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #aaaadd;">
              Your Name
            </label>
            <input 
              type="text" 
              id="user-name" 
              placeholder="e.g., Ken" 
              required
              style="
                width: 100%;
                padding: 0.75rem;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid rgba(68, 150, 255, 0.3);
                border-radius: 6px;
                color: #e0e0e0;
                font-size: 1rem;
                box-sizing: border-box;
              "
            />
          </div>

          <!-- API Key Input -->
          <div>
            <label style="display: block; margin-bottom: 0.5rem; font-weight: 500; color: #aaaadd;">
              Gateway Token (API Key)
            </label>
            <textarea 
              id="api-key" 
              placeholder="Paste your gateway token here (stored locally, never transmitted)" 
              required
              rows="4"
              style="
                width: 100%;
                padding: 0.75rem;
                background: rgba(255, 255, 255, 0.05);
                border: 1px solid rgba(68, 150, 255, 0.3);
                border-radius: 6px;
                color: #e0e0e0;
                font-size: 0.9rem;
                box-sizing: border-box;
                font-family: monospace;
                resize: vertical;
              "
            ></textarea>
            <p style="font-size: 0.85em; color: #6666aa; margin: 0.5rem 0 0 0;">
              üîê Your token is stored locally in your browser and never sent to external servers.
            </p>
          </div>

          <!-- Persona Selection -->
          <div>
            <label style="display: block; margin-bottom: 0.75rem; font-weight: 500; color: #aaaadd;">
              Pinky's Personality Style
            </label>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
              <label class="persona-option" style="
                display: flex;
                align-items: center;
                padding: 0.75rem;
                background: rgba(68, 150, 255, 0.1);
                border: 2px solid rgba(68, 150, 255, 0.3);
                border-radius: 6px;
                cursor: pointer;
                transition: all 0.2s;
              ">
                <input type="radio" name="persona" value="professional" checked style="margin-right: 0.5rem;" />
                <div>
                  <div style="font-weight: 500;">Professional</div>
                  <div style="font-size: 0.8em; color: #9999cc;">Formal and precise</div>
                </div>
              </label>
              <label class="persona-option" style="
                display: flex;
                align-items: center;
                padding: 0.75rem;
                background: rgba(68, 150, 255, 0.1);
                border: 2px solid rgba(68, 150, 255, 0.3);
                border-radius: 6px;
                cursor: pointer;
                transition: all 0.2s;
              ">
                <input type="radio" name="persona" value="casual" style="margin-right: 0.5rem;" />
                <div>
                  <div style="font-weight: 500;">Casual</div>
                  <div style="font-size: 0.8em; color: #9999cc;">Friendly and relaxed</div>
                </div>
              </label>
              <label class="persona-option" style="
                display: flex;
                align-items: center;
                padding: 0.75rem;
                background: rgba(68, 150, 255, 0.1);
                border: 2px solid rgba(68, 150, 255, 0.3);
                border-radius: 6px;
                cursor: pointer;
                transition: all 0.2s;
              ">
                <input type="radio" name="persona" value="creative" style="margin-right: 0.5rem;" />
                <div>
                  <div style="font-weight: 500;">Creative</div>
                  <div style="font-size: 0.8em; color: #9999cc;">Playful and inventive</div>
                </div>
              </label>
              <label class="persona-option" style="
                display: flex;
                align-items: center;
                padding: 0.75rem;
                background: rgba(68, 150, 255, 0.1);
                border: 2px solid rgba(68, 150, 255, 0.3);
                border-radius: 6px;
                cursor: pointer;
                transition: all 0.2s;
              ">
                <input type="radio" name="persona" value="analytical" style="margin-right: 0.5rem;" />
                <div>
                  <div style="font-weight: 500;">Analytical</div>
                  <div style="font-size: 0.8em; color: #9999cc;">Data-driven and logical</div>
                </div>
              </label>
            </div>
          </div>
        </form>
      </div>

      <!-- Slide 6: Ready to Go -->
      <div class="onboarding-slide" data-slide="6" style="display: none;">
        <div style="text-align: center;">
          <div style="font-size: 4em; margin-bottom: 1rem; animation: pulse 2s infinite;">üöÄ</div>
          <h2 style="margin: 0 0 0.5rem 0; font-size: 2em; color: #4496ff;">You're All Set!</h2>
          <p style="color: #aaaadd; font-size: 1.1em; margin: 0 0 2rem 0;">Your AI assistant is ready for action</p>
        </div>
        
        <div style="
          background: rgba(68, 150, 255, 0.1);
          border: 1px solid rgba(68, 150, 255, 0.3);
          border-radius: 12px;
          padding: 2rem;
          margin-bottom: 2rem;
        ">
          <h3 style="margin: 0 0 1rem 0; color: #e0e0e0; text-align: center;">Quick Start Tips</h3>
          <div style="display: flex; flex-direction: column; gap: 1rem;">
            <div style="display: flex; align-items: start; gap: 1rem;">
              <div style="
                background: rgba(68, 150, 255, 0.2);
                width: 30px;
                height: 30px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-shrink: 0;
              ">1</div>
              <p style="margin: 0; color: #e0e0e0; line-height: 1.5;">
                Start by exploring the <strong>Dashboard</strong> to see your system overview
              </p>
            </div>
            <div style="display: flex; align-items: start; gap: 1rem;">
              <div style="
                background: rgba(68, 150, 255, 0.2);
                width: 30px;
                height: 30px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-shrink: 0;
              ">2</div>
              <p style="margin: 0; color: #e0e0e0; line-height: 1.5;">
                Click on <strong>TasksBot</strong> to create your first task
              </p>
            </div>
            <div style="display: flex; align-items: start; gap: 1rem;">
              <div style="
                background: rgba(68, 150, 255, 0.2);
                width: 30px;
                height: 30px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-shrink: 0;
              ">3</div>
              <p style="margin: 0; color: #e0e0e0; line-height: 1.5;">
                Visit <strong>Settings</strong> to customize notifications and preferences
              </p>
            </div>
            <div style="display: flex; align-items: start; gap: 1rem;">
              <div style="
                background: rgba(68, 150, 255, 0.2);
                width: 30px;
                height: 30px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-shrink: 0;
              ">4</div>
              <p style="margin: 0; color: #e0e0e0; line-height: 1.5;">
                Press <strong>?</strong> anytime to see keyboard shortcuts
              </p>
            </div>
          </div>
        </div>

        <div style="
          background: linear-gradient(135deg, rgba(68, 150, 255, 0.2) 0%, rgba(100, 180, 255, 0.1) 100%);
          border-radius: 8px;
          padding: 1.5rem;
          text-align: center;
        ">
          <p style="margin: 0 0 0.5rem 0; color: #e0e0e0; font-size: 1.1em;">
            <strong>Need Help?</strong>
          </p>
          <p style="margin: 0; color: #aaaadd; line-height: 1.5;">
            Hover over any element to see tooltips, or visit our documentation at 
            <a href="https://pinkybot.io/docs" style="color: #4496ff; text-decoration: none;">pinkybot.io/docs</a>
          </p>
        </div>
      </div>

    </div>

    <!-- Navigation Buttons -->
    <div style="
      position: sticky;
      bottom: 0;
      background: rgba(20, 40, 80, 0.98);
      padding: 1.5rem 2rem;
      border-top: 1px solid rgba(68, 150, 255, 0.2);
      display: flex;
      justify-content: space-between;
      gap: 1rem;
    ">
      <button id="prev-btn" style="
        padding: 0.75rem 1.5rem;
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(68, 150, 255, 0.3);
        color: #e0e0e0;
        border-radius: 6px;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.2s;
        opacity: 0.5;
        pointer-events: none;
      ">
        ‚Üê Previous
      </button>
      <button id="next-btn" style="
        padding: 0.75rem 1.5rem;
        background: linear-gradient(135deg, #4496ff 0%, #2270dd 100%);
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
      ">
        Next ‚Üí
      </button>
      <button id="finish-btn" style="
        display: none;
        padding: 0.75rem 2rem;
        background: linear-gradient(135deg, #44ff96 0%, #22dd70 100%);
        color: #0a1428;
        border: none;
        border-radius: 6px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
      ">
        Launch Dashboard üöÄ
      </button>
    </div>
  </div>
</div>

<style>
  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }
  
  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }
  
  .onboarding-slide {
    animation: slideIn 0.3s ease-out;
  }
  
  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateX(20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }
  
  .persona-option:hover {
    background: rgba(68, 150, 255, 0.2) !important;
    border-color: rgba(68, 150, 255, 0.6) !important;
    transform: translateY(-2px);
  }
  
  .persona-option:has(input:checked) {
    background: rgba(68, 150, 255, 0.3) !important;
    border-color: #4496ff !important;
  }
  
  #next-btn:hover, #finish-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(68, 150, 255, 0.4);
  }
  
  #prev-btn:not([disabled]):hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateY(-2px);
  }
  
  #skip-tour:hover {
    background: rgba(68, 150, 255, 0.1);
    border-color: rgba(68, 150, 255, 0.5);
  }
  
  .progress-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: rgba(68, 150, 255, 0.3);
    transition: all 0.3s;
  }
  
  .progress-dot.active {
    background: #4496ff;
    transform: scale(1.3);
  }
</style>

<script>
  (function() {
    'use strict';

    let currentSlide = 1;
    const totalSlides = 6;

    // Check if user already onboarded
    function isUserOnboarded() {
      return localStorage.getItem('pinky_onboarded') === 'true';
    }

    // Hide onboarding
    function hideOnboarding() {
      const overlay = document.getElementById('onboarding-overlay');
      if (overlay) {
        overlay.style.display = 'none';
      }
    }

    // Show onboarding
    function showOnboarding() {
      const overlay = document.getElementById('onboarding-overlay');
      if (overlay) {
        overlay.style.display = 'flex';
      }
    }

    // Initialize progress dots
    function initProgressDots() {
      const container = document.getElementById('progress-dots');
      container.innerHTML = '';
      for (let i = 1; i <= totalSlides; i++) {
        const dot = document.createElement('div');
        dot.className = 'progress-dot' + (i === 1 ? ' active' : '');
        dot.dataset.slide = i;
        container.appendChild(dot);
      }
    }

    // Update UI for current slide
    function updateSlide() {
      // Hide all slides
      document.querySelectorAll('.onboarding-slide').forEach(slide => {
        slide.style.display = 'none';
      });
      
      // Show current slide
      const currentSlideEl = document.querySelector(`[data-slide="${currentSlide}"]`);
      if (currentSlideEl) {
        currentSlideEl.style.display = 'block';
      }
      
      // Update progress dots
      document.querySelectorAll('.progress-dot').forEach((dot, idx) => {
        dot.classList.toggle('active', idx + 1 === currentSlide);
      });
      
      // Update counter
      document.getElementById('slide-counter').textContent = `Step ${currentSlide} of ${totalSlides}`;
      
      // Update buttons
      const prevBtn = document.getElementById('prev-btn');
      const nextBtn = document.getElementById('next-btn');
      const finishBtn = document.getElementById('finish-btn');
      
      prevBtn.disabled = currentSlide === 1;
      prevBtn.style.opacity = currentSlide === 1 ? '0.5' : '1';
      prevBtn.style.pointerEvents = currentSlide === 1 ? 'none' : 'auto';
      
      if (currentSlide === totalSlides) {
        nextBtn.style.display = 'none';
        finishBtn.style.display = 'block';
      } else {
        nextBtn.style.display = 'block';
        finishBtn.style.display = 'none';
      }
    }

    // Navigate to next slide
    function nextSlide() {
      // If on setup slide (5), validate form
      if (currentSlide === 5) {
        const form = document.getElementById('onboarding-form');
        const userName = document.getElementById('user-name').value;
        const apiKey = document.getElementById('api-key').value;
        
        if (!userName.trim() || !apiKey.trim()) {
          alert('Please fill in all required fields');
          return;
        }
        
        // Save settings
        const persona = document.querySelector('input[name="persona"]:checked').value;
        localStorage.setItem('pinky_user_name', userName);
        localStorage.setItem('pinky_api_key', apiKey);
        localStorage.setItem('pinky_persona', persona);
      }
      
      if (currentSlide < totalSlides) {
        currentSlide++;
        updateSlide();
      }
    }

    // Navigate to previous slide
    function prevSlide() {
      if (currentSlide > 1) {
        currentSlide--;
        updateSlide();
      }
    }

    // Skip tour
    function skipTour() {
      if (confirm('Are you sure you want to skip the tour? You can always restart it from Settings.')) {
        localStorage.setItem('pinky_onboarded', 'true');
        hideOnboarding();
      }
    }

    // Finish onboarding
    function finishOnboarding() {
      localStorage.setItem('pinky_onboarded', 'true');
      console.log('[Onboarding] Tour complete');
      hideOnboarding();
      
      // Notify dashboard
      if (window.pinkySettings) {
        window.pinkySettings.loadSettings();
      }
      
      // Show welcome message
      setTimeout(() => {
        if (window.dashboard && window.dashboard.showToast) {
          window.dashboard.showToast('Welcome to PinkyBot! üéâ', 'success');
        }
      }, 500);
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      // Check if already onboarded
      if (isUserOnboarded()) {
        hideOnboarding();
        return;
      }
      
      showOnboarding();
      initProgressDots();
      updateSlide();
      
      // Event listeners
      document.getElementById('next-btn')?.addEventListener('click', nextSlide);
      document.getElementById('prev-btn')?.addEventListener('click', prevSlide);
      document.getElementById('finish-btn')?.addEventListener('click', finishOnboarding);
      document.getElementById('skip-tour')?.addEventListener('click', skipTour);
      
      // Keyboard navigation
      document.addEventListener('keydown', (e) => {
        const overlay = document.getElementById('onboarding-overlay');
        if (!overlay || overlay.style.display === 'none') return;
        
        if (e.key === 'ArrowRight' && currentSlide < totalSlides) {
          nextSlide();
        } else if (e.key === 'ArrowLeft' && currentSlide > 1) {
          prevSlide();
        } else if (e.key === 'Enter' && currentSlide === totalSlides) {
          finishOnboarding();
        }
      });
    });

    // Expose to global
    window.onboardingTour = {
      show: showOnboarding,
      hide: hideOnboarding,
      isOnboarded: isUserOnboarded,
      reset: function() {
        localStorage.removeItem('pinky_onboarded');
        localStorage.removeItem('pinky_user_name');
        localStorage.removeItem('pinky_api_key');
        localStorage.removeItem('pinky_persona');
        currentSlide = 1;
        showOnboarding();
        updateSlide();
      }
    };
  })();
</script>
